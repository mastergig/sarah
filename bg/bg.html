<html>
	<head>
		<title>Sarah Chibi Arts - Teste do BG</title>
		<style type='text/css'>
			body,html,#stars-bg,#main{
				margin: 0;
				padding: 0;
				width: 100%;
				height: 100%;
			}
			#stars-bg{
				background: linear-gradient(#FC9,#FFEC9D,#FFF6A1,#FFF7DD,#FFF6A1,#FFEC9D,#FC9);
				position: fixed;
				z-index: -5;
			}
			#main{
				z-index: 5;
			}
			.star-fill{
				position: absolute;
				transition: all 3.01s linear, opacity 2.5s ease-in;
			}
		</style>
		<script type='text/javascript'>
			var stars;
			var starId = "randomStar";
			var defaultStarsColors = [
				"star1.gif",
				"star2.gif",
				"star3.gif",
				"star4.gif",
				"star5.gif"
			];
			var rotation = {
				min : 100,
				max : 500
			}
			var speed = {
				min : 15,
				max : 39
			}
			var size = {
				min : 35,
				max : 90
			}
			var startPosX = {
				min : -99,
				max : 99
			}	
			var startPosY = {
				min : -1,
				max : 99
			}
			var maxStars = 150;
			var updateT = 3000;
			var inicio = 2;
			
			function startStars()
			{
				stars = [];
				for(var i = 0; i < maxStars; i++)
				{
					stars.push(randomStar(starId+i , randomNumAbs(startPosX.min, startPosX.max)-1));
				}
				drawStars();
			}
			function drawStars()
			{
				var starsHtml = "";
				
				for(var i = 0; i < maxStars; i++)
				{
					starsHtml += createStar(stars[i]);
				}
				document.getElementById("stars-bg").innerHTML = starsHtml;
				
				updateStars();
			}
			function createStar(star)
			{
				var newStar = "<img id='" + star.id + "' src='" + star.backImage + "' class='star-fill' style='";

				newStar += " width: " + star.size + "px;";
				newStar += " height: " + star.size + "px;";
				newStar += " transform: rotate(" + star.rotation + "deg);";
				newStar += " top: " + star.posY + "%;";
				newStar += " left: " + star.posX + "%;";
				newStar += " opacity: 1;";

				newStar += "' />";

				return newStar;
			}
			function starReborn(i)
			{
				//console.log(i);
				var estrela = document.getElementById(stars[i].id);
				var estrelado = document.getElementById("stars-bg");
				
				estrela.remove();
				stars[i] = randomStar(stars[i].id,0);

				estrelado.insertAdjacentHTML('beforeend', createStar(stars[i]));
			}
			function updateStars()
			{
				for(var i = 0; i < maxStars; i++)
				{
					var estrela = document.getElementById(stars[i].id);

					if(stars[i].posX > (200 + (1*stars[i].speed))) estrela.style.display = "none";
					if(stars[i].posX < 0) estrela.style.display = "block";

					stars[i].rotation += stars[i].rotationSpeed;
					stars[i].posX += stars[i].speed;

					estrela.style.transform = "rotate("+ stars[i].rotation +"deg)";
					estrela.style.left = stars[i].posX +"%";

					if(stars[i].posX >= 100)
					{
						var limite = 100 + stars[i].speed;
						estrela.style.opacity = "0";
						if(stars[i].posX > limite) starReborn(i);
					}
				}
				setTimeout(function(){updateStars()}, updateT/inicio);
				if(inicio > 1) inicio--;
			}
			function randomStar(id,x)
			{
				var newStar = {
					id : id,
					backImage : "",
					posX : x,
					posY : 0,
					rotationSpeed : 0,
					rotation : 0,
					speed : 0,
					size : 0
				}

				newStar.backImage = defaultStarsColors[randomNumInt(0, (defaultStarsColors.length))];
				newStar.posY = randomNumAbs(startPosY.min, startPosY.max);
				newStar.rotationSpeed = randomNumAbs(rotation.min, rotation.max);
				newStar.rotation = randomNumAbs(0, 360);
				newStar.speed = randomNumAbs(speed.min, speed.max);
				newStar.size = randomNumInt(size.min, size.max);

				if(x == 0) newStar.posX = -newStar.size;

				return newStar;
			}
			function randomNumAbs(min, max) {
				var ret = Math.random() * (max - min) + min;
				return ret;
			}
			function randomNumInt(min, max) {
				min = Math.ceil(min);
				max = Math.floor(max);
				var ret = Math.floor(Math.random() * (max - min)) + min;
				return ret;
			}
		</script>
	</head>
	
	<body onload="startStars()">
		<div id="stars-bg" aria-hidden="true"></div>
		<div id="main">Teste do background</div>
	</body>
</html>